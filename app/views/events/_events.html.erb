<table class="table">
<thead>
    <tr>
        <th>Evènement</th>
        <th>Date</th>
        <th>Prix</th>
        <th>Lieu</th>
        <th>Organisateur</th>
        <th>Participants</th>
        <% if member_signed_in? && !current_member.has_role?(:professional) %>
            <th></th>
        <% end %>
    </tr>
</thead>

<tbody>
    <% @events.each do |event| %>
    <tr>
        <td><%= link_to event.title, event %></td>
        <td><%= I18n.l(event.begin, format: '%-d %b - %Hh%M') %></td>
        <td>
            <%= event.price_min.to_s + '€ - ' if event.price_min != event.price_max %>
            <%= event.price_max.to_s + '€' %>
        </td>
        <td class="location pointer" onclick="showMap(<%= event.zip %>)">
            <span class="location_icon glyphicon glyphicon-map-marker" aria-hidden="true"></span> 
            <%= event.zip %>
        </td>
        <td>
            <% if event.organizer.has_role?(:professional) %>
                <span class="glyphicon glyphicon-flash" aria-hidden="true"></span>
            <% end %>
            <%= link_to event.organizer.pseudo, event.organizer %>
        </td>
        <td>
            <% if event.attendees.size == event.members_max %>
                <%= 'complet' %>
            <% else %>
                <%= event.attendees.size.to_s + ' / ' + event.members_max.to_s %>
            <% end %>
            </td>
        <% if member_signed_in? && !current_member.has_role?(:professional) %>
            <td>
                <% if event.participate?(current_member) %>
                    <%= link_to 'Se désinscrire', participate_path(id: event.id, status: 'out'), class: 'badge', remote: true %>
                <% else %>
                    <%= link_to 'Y participer', participate_path(id: event.id, status: 'in'), class: 'badge', remote: true if event.attendees.size != event.members_max %>
                <% end %>
            </td>
        <% end %>
    </tr>
    <% end %>
</tbody>
</table>