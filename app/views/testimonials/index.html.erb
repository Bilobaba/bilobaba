<div class="container">
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-lg" data-toggle="modal" data-target="#myModal">
    Présentation
  </button>

  <div style="display: flex; justify-content: space-between;">
    <div>
      <h2>Les témoignages</h2>
    </div>
    <div>
      <% if member_signed_in? %>
        <%= link_to 'Ajouter votre témoignage', new_testimonial_path, class: 'btn btn-default', style: 'font-size: 110%' %>
      <% else %>
        <%= link_to  '#','data-toggle':'modal', 'data-target':'#connection', class: 'btn btn-default'  do %>
                  Ajouter votre témoignage
        <% end %>
      <% end %>
    </div>
  </div>
  <table class='table'>
    <thead>
      <tr>
        <th>Titre</th>
        <th>Auteur</th>
        <th>Thèmes</th>
      </tr>
    </thead>
    <tbody>
      <% @testimonials.each do |testimonial| %>
        <tr>
          <td><%= link_to testimonial.title, testimonial %></td>
          <td><%= link_to testimonial.member.pseudo, testimonial.member %></td>
          <td><%= raw testimonial.topic_list.map { |t| link_to t, topic_path(t), title: "les témoignages portant sur #{t}" }.join(', ') %></td>
      <% end %>
    </tbody>
  </table>

  <br>

  <% if member_signed_in? %>
    <%= link_to 'Ajouter votre témoignage', new_testimonial_path, class: 'btn btn-default' %>
  <% else %>
    <%= link_to  '#','data-toggle':'modal', 'data-target':'#connection', class: 'btn btn-default'  do %>
              Ajouter votre témoignage
    <% end %>
  <% end %>

</div>


<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Pourquoi ces témoignages ?</h4>
      </div>
      <div class="modal-body">
        <%= simple_format("
        Ces textes ont été ecrits par des membres du site qui pensent que leurs récits pourraient vous éclairer d'une façon ou d'une autre sur leurs pratiques. Certaines d'elles sont peu connues et méritent qu'on prennent du temps pour expliquer ce qu'on peut y vivre.

        Il n'y a aucune promesse, aucune motivation à vous pousser de faire la même chose.

        Les auteurs se sont engagés à ne pas avoir été motivé par un avantage financier, en nature ou autre contre partie qui pourrait mettre en doute la sincérité et l'intégrité du témoignage.

        Seuls les témoignages positifs sont publiés. C'est arbitraire et complètement assumé. Nous ne cherchons pas à analyser objectivement une pratique. Au contraire, nous sommes ici dans le subjectif, l'arbitraire et d'un point de vu totalement personnel.

        Ces témoignages ont été rédigés à la manière d'une lettre d'un ami à un ami. C'est une expérience parmi d'autres. Elle est réelle. Elle est sincère.

        Nous espérons que vous aur
        ") %>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Fermer</button>
      </div>
    </div>
  </div>
</div>

<script>
<% if !cookies[VIEWED_TESTIMONIALS] %>
   $('#myModal').modal('show');
<% end %>
</script>
